# –ê–Ω–∞–ª–∏–∑ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ SettingsPage.tsx

## üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –û–®–ò–ë–ö–ò

### 1. –ù–µ–≤–µ—Ä–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ö—É–∫–∞ `useSubscription` (—Å—Ç—Ä–æ–∫–∞ 13)
**–ü—Ä–æ–±–ª–µ–º–∞:** –•—É–∫ `useSubscription` –∏–∑ `features/subscription/model/useSubscription.ts` —Ç—Ä–µ–±—É–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä `token: string | null`, –Ω–æ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤.

**–ö–æ–¥:**
```typescript
const { allSymbols, toggleSubscription, isSubscribed, isLoading, error } = useSubscription();
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –ù—É–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å token:
```typescript
const { utipToken, acsToken } = useAuth();
const token = utipToken || acsToken || null;
const { allSymbols, toggleSubscription, isSubscribed, isLoading, error } = useSubscription(token);
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –í–æ–∑–º–æ–∂–Ω–æ, –≤ –ø—Ä–æ–µ–∫—Ç–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∞—è –≤–µ—Ä—Å–∏—è –∏–∑ `context/SubscriptionContext.tsx`, –Ω–æ –∏–º–ø–æ—Ä—Ç —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –≤–µ—Ä—Å–∏—é –∏–∑ features, –∫–æ—Ç–æ—Ä–∞—è —Ç—Ä–µ–±—É–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä.

---

## ‚ö†Ô∏è –ü–†–û–ë–õ–ï–ú–´ –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–ò

### 2. –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –º–∞—Å—Å–∏–≤–∞ –Ω–∞ –∫–∞–∂–¥–æ–º —Ä–µ–Ω–¥–µ—Ä–µ (—Å—Ç—Ä–æ–∫–∏ 91-98)
**–ü—Ä–æ–±–ª–µ–º–∞:** –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Ä–µ–Ω–¥–µ—Ä–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞, –¥–∞–∂–µ –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –Ω–µ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å.

**–¢–µ–∫—É—â–∏–π –∫–æ–¥:**
```typescript
{[...allSymbols]
  .sort((a, b) => {
    const aSubscribed = isSubscribed(a.Symbol);
    const bSubscribed = isSubscribed(b.Symbol);
    // ...
  })
  .map(symbol => ...)
}
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `useMemo`:
```typescript
const sortedSymbols = useMemo(() => {
  return [...allSymbols].sort((a, b) => {
    const aSubscribed = isSubscribed(a.Symbol);
    const bSubscribed = isSubscribed(b.Symbol);
    if (aSubscribed && !bSubscribed) return -1;
    if (!aSubscribed && bSubscribed) return 1;
    return (a.Symbol || '').localeCompare(b.Symbol || '');
  });
}, [allSymbols, isSubscribed]);
```

### 3. –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –≤—ã–∑–æ–≤—ã `isSubscribed()` –¥–ª—è –æ–¥–Ω–æ–≥–æ —Å–∏–º–≤–æ–ª–∞
**–ü—Ä–æ–±–ª–µ–º–∞:** –í —Å—Ç—Ä–æ–∫–∞—Ö 93-94, 110, 112, 116, 121 —Ñ—É–Ω–∫—Ü–∏—è `isSubscribed()` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è 5 —Ä–∞–∑ –¥–ª—è –æ–¥–Ω–æ–≥–æ –∏ —Ç–æ–≥–æ –∂–µ —Å–∏–º–≤–æ–ª–∞ –≤ –æ–¥–Ω–æ–º —Ä–µ–Ω–¥–µ—Ä–µ.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –í—ã—á–∏—Å–ª–∏—Ç—å —Å—Ç–∞—Ç—É—Å –ø–æ–¥–ø–∏—Å–∫–∏ –æ–¥–∏–Ω —Ä–∞–∑:
```typescript
.map(symbol => {
  const subscribed = isSubscribed(symbol.Symbol);
  return (
    <div key={symbol.Symbol} ...>
      {/* –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å subscribed –≤–º–µ—Å—Ç–æ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ */}
    </div>
  );
})
```

### 4. –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –º–∞—Å—Å–∏–≤–∞ –Ω–∞ –∫–∞–∂–¥–æ–º —Ä–µ–Ω–¥–µ—Ä–µ (—Å—Ç—Ä–æ–∫–∞ 91)
**–ü—Ä–æ–±–ª–µ–º–∞:** `[...allSymbols]` —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π –º–∞—Å—Å–∏–≤ –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Ä–µ–Ω–¥–µ—Ä–µ.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `useMemo` (—Å–º. –ø—É–Ω–∫—Ç 2).

---

## üêõ –ü–û–¢–ï–ù–¶–ò–ê–õ–¨–ù–´–ï –ë–ê–ì–ò

### 5. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ null/undefined –≤ `localeCompare`
**–ü—Ä–æ–±–ª–µ–º–∞:** –ï—Å–ª–∏ `symbol.Symbol` —Ä–∞–≤–µ–Ω `null` –∏–ª–∏ `undefined`, `localeCompare` –≤—ã–±—Ä–æ—Å–∏—Ç –æ—à–∏–±–∫—É.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
```typescript
return (a.Symbol || '').localeCompare(b.Symbol || '');
```

### 6. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤
**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Ç —è–≤–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–µ—Ä–µ–¥ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–æ–º —Å–ø–∏—Å–∫–∞.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
```typescript
{!isLoading && !error && sortedSymbols.length > 0 && (
  <div className="symbolList">
    {sortedSymbols.map(...)}
  </div>
)}
{!isLoading && !error && sortedSymbols.length === 0 && (
  <div>No symbols available</div>
)}
```

---

## ‚ôø –ü–†–û–ë–õ–ï–ú–´ –î–û–°–¢–£–ü–ù–û–°–¢–ò (A11Y)

### 7. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ `aria-label` —É –∫–Ω–æ–ø–æ–∫
**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–Ω–æ–ø–∫–∏ –Ω–µ –∏–º–µ—é—Ç —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –º–µ—Ç–æ–∫ –¥–ª—è —Å–∫—Ä–∏–Ω—Ä–∏–¥–µ—Ä–æ–≤.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
```typescript
<button
  onClick={toggleTheme}
  aria-label={`Switch to ${theme === 'dark' ? 'light' : 'dark'} mode`}
  ...
>
```

```typescript
<button
  onClick={() => toggleSubscription(symbol.Symbol)}
  aria-label={subscribed ? `Unsubscribe from ${symbol.Symbol}` : `Subscribe to ${symbol.Symbol}`}
  ...
>
```

### 8. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ `aria-busy` –≤–æ –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏
**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
```typescript
<div className="symbolList" aria-busy={isLoading} aria-live="polite">
```

---

## üîí –ü–†–û–ë–õ–ï–ú–´ –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò

### 9. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö
**–ü—Ä–æ–±–ª–µ–º–∞:** `symbol.Symbol` –∏ `symbol.Description` –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏. –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏—Ö–æ–¥—è—Ç –∏–∑ –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞, –≤–æ–∑–º–æ–∂–µ–Ω XSS.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** React –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —ç–∫—Ä–∞–Ω–∏—Ä—É–µ—Ç —Å—Ç—Ä–æ–∫–∏, –Ω–æ –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
- –í–∞–ª–∏–¥–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —É—Ä–æ–≤–Ω–µ API
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫ —Ç–∏–ø–∞ DOMPurify –¥–ª—è HTML-–∫–æ–Ω—Ç–µ–Ω—Ç–∞ (–µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è)

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏—Ö–æ–¥—è—Ç –∏–∑ WebSocket –∏–ª–∏ API, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ —É—Ä–æ–≤–Ω–µ —Ç–∏–ø–æ–≤ –∏ runtime.

---

## üìã –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

### 10. –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ –ø—Ä–∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–µ
```typescript
const sortedSymbols = useMemo(() => {
  try {
    return [...allSymbols].sort((a, b) => {
      // –ª–æ–≥–∏–∫–∞ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
    });
  } catch (error) {
    console.error('Error sorting symbols:', error);
    return allSymbols; // fallback –∫ –∏—Å—Ö–æ–¥–Ω–æ–º—É –º–∞—Å—Å–∏–≤—É
  }
}, [allSymbols, isSubscribed]);
```

### 11. –î–æ–±–∞–≤–∏—Ç—å key –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ React
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –£–∂–µ –µ—Å—Ç—å `key={symbol.Symbol}` –Ω–∞ —Å—Ç—Ä–æ–∫–µ 100.

### 12. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å—Ç–∏–ª–µ–π
**–ü—Ä–æ–±–ª–µ–º–∞:** –ò–Ω–ª–∞–π–Ω-—Å—Ç–∏–ª–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –Ω–∞ –∫–∞–∂–¥–æ–º —Ä–µ–Ω–¥–µ—Ä–µ.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –í—ã–Ω–µ—Å—Ç–∏ —Å—Ç–∏–ª–∏ –≤ CSS-–∫–ª–∞—Å—Å—ã –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `useMemo` –¥–ª—è –æ–±—ä–µ–∫—Ç–æ–≤ —Å—Ç–∏–ª–µ–π.

---

## üìä –ò–¢–û–ì–û–í–ê–Ø –û–¶–ï–ù–ö–ê

- **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏:** 1
- **–ü—Ä–æ–±–ª–µ–º—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:** 3
- **–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –±–∞–≥–∏:** 2
- **–ü—Ä–æ–±–ª–µ–º—ã –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏:** 2
- **–ü—Ä–æ–±–ª–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:** 1

**–û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞:** –¢—Ä–µ–±—É–µ—Ç—Å—è —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

